"use strict";angular.module("ngGeolocation",[]).factory("$geolocation",["$rootScope","$window","$q",function(b,e,c){function a(){return"geolocation" in e.navigator}var d={getCurrentPosition:function(g){var f=c.defer();if(a()){e.navigator.geolocation.getCurrentPosition(function(h){b.$apply(function(){d.position.coords=h.coords;d.position.timestamp=h.timestamp;f.resolve(h)})},function(h){b.$apply(function(){f.reject({error:h})})},g)}else{f.reject({error:{code:2,message:"This web browser does not support HTML5 Geolocation"}})}return f.promise},watchPosition:function(f){if(a()){if(!this.watchId){this.watchId=e.navigator.geolocation.watchPosition(function(g){b.$apply(function(){d.position.coords=g.coords;d.position.timestamp=g.timestamp;delete d.position.error;b.$broadcast("$geolocation.position.changed",g)})},function(g){b.$apply(function(){d.position.error=g;delete d.position.coords;delete d.position.timestamp;b.$broadcast("$geolocation.position.error",g)})},f)}}else{d.position={error:{code:2,message:"This web browser does not support HTML5 Geolocation"}}}},clearWatch:function(){if(this.watchId){e.navigator.geolocation.clearWatch(this.watchId);delete this.watchId}},position:{}};return d}]);