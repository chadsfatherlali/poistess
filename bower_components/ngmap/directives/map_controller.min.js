(function(){var a=function(e,d,c,g,f){var i=f;var h=this;var b=function(k,l,j){k.$observe(l,function(n){if(n){console.log("observing ",j,l,n);var m=i.camelCase("set-"+l);var o=i.toOptionValue(n,{key:l});console.log("setting ",j,l,"with value",o);if(j[m]){if(l.match(/center|position/)&&typeof o=="string"){h.getGeoLocation(o).then(function(p){j[m](p)})}else{j[m](o)}}}})};this.map=null;this._objects=[];this.addObject=function(l,k){if(this.map){this.map[l]=this.map[l]||{};var j=Object.keys(this.map[l]).length;this.map[l][k.id||j]=k;if(l!="infoWindows"&&k.setMap){k.setMap&&k.setMap(this.map)}if(k.centered&&k.position){this.map.setCenter(k.position)}e.$emit("objectChanged",[l,this.map[l]])}else{k.groupName=l;this._objects.push(k)}};this.deleteObject=function(m,k){if(k.map){var l=k.map[m];for(var j in l){l[j]===k&&(delete l[j])}k.map&&k.setMap&&k.setMap(null);e.$emit("objectChanged",[m,this.map[m]])}};this.addObjects=function(k){for(var j=0;j<k.length;j++){var l=k[j];if(l instanceof google.maps.Marker){this.addObject("markers",l)}else{if(l instanceof google.maps.Circle||l instanceof google.maps.Polygon||l instanceof google.maps.Polyline||l instanceof google.maps.Rectangle||l instanceof google.maps.GroundOverlay){this.addObject("shapes",l)}else{this.addObject(l.groupName,l)}}}};this.getGeoLocation=function(k){var j=d.defer();if(!k||k.match(/^current/i)){c.getCurrentPosition().then(function(l){var o=l.coords.latitude;var m=l.coords.longitude;var n=new google.maps.LatLng(o,m);j.resolve(n)},function(l){j.reject(l)})}else{g.geocode({address:k}).then(function(l){j.resolve(l[0].geometry.location)},function(l){j.reject(l)})}return j.promise};this.observeAttrSetObj=function(j,k,n){var m=i.getAttrsToObserve(j);if(Object.keys(m).length){console.log(n,"attributes to observe",m)}for(var l=0;l<m.length;l++){b(k,m[l],n)}};this.zoomToIncludeMarkers=function(){var k=new google.maps.LatLngBounds();for(var j in this.map.markers){k.extend(this.map.markers[j].getPosition())}this.map.fitBounds(k)}};a.$inject=["$scope","$q","NavigatorGeolocation","GeoCoder","Attr2Options"];angular.module("ngMap").controller("MapController",a)})();