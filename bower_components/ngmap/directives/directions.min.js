(function(){var a=function(d,e){if(d.panel){d.panel=document.getElementById(d.panel)||document.querySelector(d.panel)}var f=new google.maps.DirectionsRenderer(d);for(var c in e){google.maps.event.addListener(f,c,e[c])}return f};var b=function(f,e,d){var i=f;var h=new google.maps.DirectionsService();var g=function(o,j){var m=j;m.travelMode=m.travelMode||"DRIVING";var l=["origin","destination","travelMode","transitOptions","unitSystem","durationInTraffic","waypoints","optimizeWaypoints","provideRouteAlternatives","avoidHighways","avoidTolls","region"];for(var k in m){(l.indexOf(k)===-1)&&(delete m[k])}if(m.waypoints){if(m.waypoints=="[]"||m.waypoints==""){delete m.waypoints}}var n=function(p){console.log("request",p);h.route(p,function(r,q){if(q==google.maps.DirectionsStatus.OK){e(function(){o.setDirections(r)})}})};if(m.origin&&m.destination){if(m.origin=="current-location"){d.getCurrentPosition().then(function(p){m.origin=new google.maps.LatLng(p.coords.latitude,p.coords.longitude);n(m)})}else{if(m.destination=="current-location"){d.getCurrentPosition().then(function(p){m.destination=new google.maps.LatLng(p.coords.latitude,p.coords.longitude);n(m)})}else{n(m)}}}};var c=function(q,l,p,j){var k=i.orgAttributes(l);var m=i.filter(p);var s=i.getOptions(m);var r=i.getEvents(q,m);var o=i.getAttrsToObserve(k);var n=a(s,r);j.addObject("directionsRenderers",n);o.forEach(function(t){(function(u){p.$observe(u,function(v){if(u=="panel"){e(function(){var x=document.getElementById(v)||document.querySelector(v);console.log("setting ",u,"with value",x);x&&n.setPanel(x)})}else{if(s[u]!==v){var w=i.toOptionValue(v,{key:u});console.log("setting ",u,"with value",w);s[u]=w;g(n,s)}}})})(t)});q.$on("mapInitialized",function(t,u){g(n,s)});q.$on("$destroy",function(t,u){j.deleteObject("directionsRenderers",n)})};return{restrict:"E",require:"^map",link:c}};b.$inject=["Attr2Options","$timeout","NavigatorGeolocation"];angular.module("ngMap").directive("directions",b)})();