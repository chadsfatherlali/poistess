(function(){var g,d,c;var f=function(h){h.preventDefault&&h.preventDefault();h.cancelBubble=true;h.stopPropagation&&h.stopPropagation()};var b=function(h){h=h||{};this.el=document.createElement("div");this.el.style.display="inline-block";this.visible=true;for(var i in h){this[i]=h[i]}};var a=function(){b.prototype=new google.maps.OverlayView();b.prototype.setContent=function(i,j){this.html=i;if(j){var l=d(i)(j);var h=l[0];var k=this;c(function(){k.content=h.innerHTML;k.el.innerHTML=k.content})}else{this.content=i;this.el.innerHTML=this.content}this.el.style.position="relative";this.el.className="custom-marker"};b.prototype.setPosition=function(i){i&&(this.position=i);if(this.getProjection()&&typeof this.position.lng=="function"){var j=this.getProjection().fromLatLngToDivPixel(this.position);var h=Math.round(j.x-(this.el.offsetWidth/2));var k=Math.round(j.y-this.el.offsetHeight-10);this.el.style.left=h+"px";this.el.style.top=k+"px"}};b.prototype.setZIndex=function(h){h&&(this.zIndex=h);this.el.style.zIndex=this.zIndex};b.prototype.setVisible=function(h){this.el.style.display=h?"inline-block":"none";this.visible=h};b.prototype.addClass=function(h){var i=this.el.className.split(" ");(i.indexOf(h)==-1)&&i.push(h);this.el.className=i.join(" ")};b.prototype.removeClass=function(i){var j=this.el.className.split(" ");var h=j.indexOf(i);(h>-1)&&j.splice(h,1);this.el.className=j.join(" ")};b.prototype.onAdd=function(){this.getPanes().overlayMouseTarget.appendChild(this.el)};b.prototype.draw=function(){this.setPosition();this.setZIndex(this.zIndex);this.setVisible(this.visible)};b.prototype.onRemove=function(){this.el.parentNode.removeChild(this.el);this.el=null}};var e=function(i,h,j){g=i;d=h;c=j;a();return{restrict:"E",require:"^map",link:function(s,n,r,k){var l=g.orgAttributes(n);var p=g.filter(r);var u=g.getOptions(p,s);var t=g.getEvents(s,p);var q=n[0].parentElement.removeChild(n[0]);console.log("custom-marker options",u);var m=new b(u);m.setContent(q.innerHTML,s);console.log("customMarker",m);console.log("custom-marker events","events");for(var o in t){google.maps.event.addDomListener(m.el,o,t[o])}k.addObject("customMarkers",m);if(!(u.position instanceof google.maps.LatLng)){k.getGeoLocation(u.position).then(function(v){m.setPosition(v)})}n.bind("$destroy",function(){k.deleteObject("customMarkers",marker)})}}};e.$inject=["Attr2Options","$compile","$timeout"];angular.module("ngMap").directive("customMarker",e)})();