(function(){var b=function(d){return new google.maps.LatLngBounds(d[0],d[1])};var c=function(n,m){var k;var l=n.name;delete n.name;console.log("shape",l,"options",n,"events",m);if(n.icons){for(var h=0;h<n.icons.length;h++){var g=n.icons[h];if(g.icon.path.match(/^[A-Z_]+$/)){g.icon.path=google.maps.SymbolPath[g.icon.path]}}}switch(l){case"circle":if(!(n.center instanceof google.maps.LatLng)){n.center=new google.maps.LatLng(0,0)}k=new google.maps.Circle(n);break;case"polygon":k=new google.maps.Polygon(n);break;case"polyline":k=new google.maps.Polyline(n);break;case"rectangle":if(n.bounds){n.bounds=b(n.bounds)}k=new google.maps.Rectangle(n);break;case"groundOverlay":case"image":var f=n.url;var e=b(n.bounds);var d={opacity:n.opacity,clickable:n.clickable,id:n.id};k=new google.maps.GroundOverlay(f,e,d);break}for(var j in m){if(m[j]){google.maps.event.addListener(k,j,m[j])}}return k};var a=function(e,f){var g=e;var d=function(r,m,q,h){var i=g.orgAttributes(m);var o=g.filter(q);var j=g.getOptions(o);var l=g.getEvents(r,o);var p,k;k=j.name;if(!(j.center instanceof google.maps.LatLng)){p=j.center}var n=c(j,l);h.addObject("shapes",n);if(p&&k=="circle"){h.getGeoLocation(p).then(function(t){n.setCenter(t);n.centered&&n.map.setCenter(t);var s=q.geoCallback;s&&f(s)(r)})}h.observeAttrSetObj(i,q,n);m.bind("$destroy",function(){h.deleteObject("shapes",n)})};return{restrict:"E",require:"^map",link:d}};a.$inject=["Attr2Options","$parse"];angular.module("ngMap").directive("shape",a)})();